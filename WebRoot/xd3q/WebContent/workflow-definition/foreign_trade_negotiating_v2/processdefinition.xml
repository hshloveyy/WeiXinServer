<?xml version="1.0" encoding="UTF-8"?>

<process-definition  xmlns=""  name="foreign_trade_negotiating_v2">


	<start-state name="押汇申请">
		<transition to="部门经理确认" name="提交部门经理"></transition>
	</start-state>


	<task-node name="部门经理确认">
	    <task name="部门经理确认"></task>
		<transition to="财务人员审核" name="确认提交"></transition>
		<transition to="业务修改" name="退回修改"></transition>
	</task-node>

	<task-node name="财务人员审核">
	    <task name="财务人员审核"></task>
		<transition to="财务经理审核" name="提交财务经理"></transition>
		<transition to="业务修改" name="退回业务修改"></transition>
	</task-node>

	<task-node name="财务经理审核">
	    <task name="财务经理审核"></task>
		<transition to="贸易公司常务副总理审核" name="提交资金部经理"></transition>
		<transition to="业务修改" name="退回修改"></transition>
	</task-node>

	<task-node name="贸管经理审核">
	    <task name="贸管经理审核"></task>
		<transition to="股份公司副总审批" name="提交股份公司副总审批"></transition>
		<transition to="业务修改" name="退回业务"></transition>
	</task-node>

	<task-node name="贸易公司常务副总理审核">
	    <task name="贸易公司常务副总理审核"></task>
		<transition to="贸管审单员审核" name="提交贸管部审核"></transition>
		<transition to="业务修改" name="退回修改"></transition>
	</task-node>

	<task-node name="股份公司副总审批">
	    <task name="股份公司副总审批"></task>
		<transition to="金额判断" name="同意"></transition>
		<transition to="贸管经理审核" name="退回贸管审核"></transition>
		<transition to="更新状态为不通过" name="不批准"></transition>
	</task-node>
    <!-- 该判断，如果是承兑申请通过后的申请的押汇，不进行金额判断，直接走“提交股份公司常务副总审批” -->
	<decision name="金额判断">
		<handler config-type="bean"  class="com.infolion.sapss.workflow.payment.NegotiatingPrice1JudgeDecisionHandler"></handler>
		<transition to="股份公司常务副总审批" name="大于200万USD或1400万CNY"></transition>
		<transition to="是否领取核销单" name="小于200万USD或1400万CNY"></transition>
	</decision>

	<task-node name="股份公司常务副总审批">
	    <task name="股份公司常务副总审批"></task>
		<transition to="金额判断1" name="同意"></transition>
		<transition to="贸管经理审核" name="退回贸管审核"></transition>
		<transition to="更新状态为不通过" name="不批准"></transition>
	</task-node>

	<task-node name="股份公司总经理审批">
	    <task name="股份公司总经理审批"></task>
		<transition to="金额判断2" name="同意"></transition>
		<transition to="贸管经理审核" name="退回贸管审核"></transition>
		<transition to="更新状态为不通过" name="不批准"></transition>
	</task-node>

	<task-node name="股份公司董事长审批">
	    <task name="股份公司董事长审批"></task>
		<transition to="是否领取核销单" name="同意"></transition>
		<transition to="贸管经理审核" name="退回贸管审核"></transition>
		<transition to="更新状态为不通过" name="不批准"></transition>
	</task-node>
    <!-- 该判断，如果是承兑申请通过后的押汇，该判断直接走“办理押汇” -->
	<decision name="金额判断1">
	    <handler config-type="bean"  class="com.infolion.sapss.workflow.payment.NegotiatingPrice2JudgeDecisionHandler"></handler>
		<transition to="股份公司总经理审批" name="大于500万USD或3500万CNY"></transition>
		<transition to="是否领取核销单" name="小于500万USD或3500万CNY"></transition>
	</decision>

	<decision name="金额判断2">
		<handler config-type="bean"  class="com.infolion.sapss.workflow.payment.Price3JudgeDecisionHandler"></handler>
		<transition to="股份公司董事长审批" name="大于1000万USD或7000万CNY"></transition>
		<transition to="是否领取核销单" name="小于1000万USD或7000万CNY"></transition>
	</decision>

	<task-node name="办理押汇">
	    <task name="办理押汇"></task>
		<transition to="押汇付款申请" name="已办理完成"></transition>
	</task-node>

	<task-node name="押汇付款申请">
	    <task name="押汇付款申请"></task>
		<transition to="部门经理确认押汇付款" name="提交部门经理确认"></transition>
	</task-node>

	<task-node name="部门经理确认押汇付款">
	    <task name="部门经理确认押汇付款"></task>
		<transition to="会计审核" name="确认提交"></transition>
		<transition to="押汇付款申请" name="退回修改押汇付款申请"></transition>
	</task-node>

	<task-node name="会计审核">
	    <task name="会计审核"></task>
		<transition to="外贸财务经理审核" name="提交部门经理"></transition>
		<transition to="押汇付款申请" name="退回修改押汇付款申请"></transition>
	</task-node>

	<task-node name="外贸财务经理审核">
	    <task name="外贸财务经理审核"></task>
		<transition to="出纳付款" name="同意付款"></transition>
		<transition to="押汇付款申请" name="退回修改押汇付款申请"></transition>
	</task-node>

	<task-node name="出纳付款">
	    <task name="出纳付款"></task>
		<transition to="填写押汇信息" name="确认"></transition>
	</task-node>

	<node name="更新状态">
		<action class="com.infolion.sapss.workflow.payment.NegotiatingProcessSuccessActionHandler"></action>
		<transition to="押汇付款申请通过"></transition>
	</node>

	<task-node name="业务修改">
	    <task name="业务修改"></task>
		<transition to="部门经理确认" name="提交部门经理"></transition>
		<transition to="更新状态为不通过" name="取消申请"></transition>
	</task-node>

	<node name="更新状态为不通过">
		<action class="com.infolion.sapss.workflow.payment.NegotiatingProcessFailureActionHandler"></action>
		<transition to="押汇付款申请不通过"></transition>
	</node>

	<task-node name="填写押汇信息">
		<task name="填写押汇信息"></task>
		<transition to="更新状态" name="押汇信息已填写"></transition>
	</task-node>

	<task-node name="填写核销单">
	    <task name="填写核销单"></task>
		<transition to="办理押汇" name="核销单号已填写"></transition>
	</task-node>

	<decision name="是否领取核销单">
		<handler config-type="bean"  class="com.infolion.sapss.workflow.payment.IfTTPaymentDecisionHandler"></handler>
		<transition to="填写核销单" name="是"></transition>
		<transition to="办理押汇" name="否"></transition>
	</decision>

	<task-node name="贸管审单员审核">
	    <task name="贸管审单员审核"></task>
		<transition to="贸管经理审核" name="提交贸管经理"></transition>
		<transition to="业务修改" name="退回修改"></transition>
	</task-node>


	<end-state name="押汇付款申请通过"></end-state>

	<end-state name="押汇付款申请不通过"></end-state>


</process-definition>