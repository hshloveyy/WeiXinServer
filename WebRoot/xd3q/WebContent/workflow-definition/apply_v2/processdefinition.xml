<?xml version="1.0" encoding="UTF-8"?>

<process-definition xmlns="" name="apply_v2">
	<start-state name="请假流程">
		<transition to="请假人员录入"></transition>
	</start-state>
	<task-node name="请假人员录入">
		<task name="请假人员录入请假条"/>
		<event type="node-enter">
			<script>System.out.println("-----------请假人员录入---------------");</script>
		</event>
		<transition to="项目经理审批" name="提交项目经理审批"></transition>
	</task-node>
	<task-node name="项目经理审批">
		<task name="项目经理审批"/>
		<event type="node-enter">
			<script>System.out.println("-----------项目经理是否同意---------------");</script>
		</event>
		<transition to="node1" name="不同意请假"></transition>
		<transition to="部门经理审批" name="部门经理审批"></transition>
	</task-node>
	<task-node name="部门经理审批">
		<task name="部门经理审批"/>
		<event type="node-enter">
			<script>System.out.println("-----------部门经理是否同意---------------");</script>
		</event>
		<transition to="node1" name="不同意请假"></transition>
		<transition to="请假表决" name="同意"></transition>
	</task-node>

	<task-node name="董事长审批">		
		<task name="董事长审批"/>
		<event type="node-enter">
			<script>System.out.println("-----------分管领导审批---------------");</script>
		</event>
		<transition to="node1" name="不同意请假"></transition>
		<transition to="node2" name="同意请假"></transition>
	</task-node>

	<process-state name="请假表决">
		<sub-process name="apply"/>
		<event type="subprocess-created">
			<script>
			System.out.println("-----------子流程创建---------------");
			com.infolion.platform.component.workflow.WorkflowService.createSubProcess(executionContext);
			</script>
		</event>
		<event type="subprocess-end">
			<script>
			System.out.println("-----------子流程结束---------------");
			com.infolion.platform.component.workflow.WorkflowService.endSubProcess(executionContext);
			</script>
		</event>
		<transition to="decision1"></transition>
	</process-state>

	<node name="node1">
		<action class="com.infolion.sample.workflow.ApplyFaileActionHandler" config-type="bean"></action>
		<transition to="不同意请假"></transition>
	</node>

	<node name="node2">
		<action class="com.infolion.sample.workflow.ApplySucessfulActionHandler" config-type="bean"></action>
		<transition to="同意请假"></transition>
	</node>

	<decision name="decision1">
		<handler config-type="bean" class="com.infolion.sample.workflow.SubProcessJudgeActionHandler"></handler>
		<transition to="董事长审批" name="表决通过"></transition>
		<transition to="node1" name="表决不通过"></transition>
	</decision>
	<end-state name="不同意请假">
		
	</end-state>

	<end-state name="同意请假">
	</end-state>
</process-definition>