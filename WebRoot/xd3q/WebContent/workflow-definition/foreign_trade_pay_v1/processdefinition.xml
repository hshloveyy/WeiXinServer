<?xml version="1.0" encoding="UTF-8"?>

<process-definition  xmlns=""  name="foreign_trade_pay_v1">


	<start-state name="外贸货款申请">
		<transition to="部门经理确认"></transition>
	</start-state>


	<task-node name="部门经理确认">
	    <task name="部门经理确认"></task>
		<transition to="是否金属部" name="确认提交"></transition>
		<transition to="修改申请单" name="退回修改"></transition>
	</task-node>

	<task-node name="部门会计审核">
	    <task name="部门会计审核"></task>
		<transition to="外贸财务经理审核" name="提交财务经理"></transition>
		<transition to="修改申请单" name="退回修改"></transition>
	</task-node>

	<task-node name="外贸财务经理审核">
	    <task name="外贸财务经理审核"></task>
		<transition to="金额判断" name="同意"></transition>
		<transition to="修改申请单" name="退回修改"></transition>
	</task-node>

	<task-node name="资金部经理审核">
	    <task name="资金部经理审核"></task>
		<transition to="贸管审单员审核" name="提交贸管部审核">
			<action class="com.infolion.sapss.workflow.payment.CreditPayCreateBankCheckActionHandler" config-type="bean"></action>
		</transition>
		<transition to="修改申请单" name="退回修改"></transition>
	</task-node>

	<decision name="金额判断">
		<handler config-type="bean"  class="com.infolion.sapss.workflow.payment.TTPriceJudgeDecisionHandler"></handler>
		<transition to="资金部经理审核" name="金额大于500万CNY"></transition>
		<transition to="贸管审单员审核" name="金额小于500万CNY"></transition>
	</decision>

	<task-node name="贸管审单员审核">
	    <task name="贸管审单员审核"></task>
		<transition to="贸管经理审核" name="提交贸管经理审核"></transition>
		<transition to="修改申请单" name="退回修改"></transition>
	</task-node>

	<task-node name="贸管经理审核">
	    <task name="贸管经理审核"></task>
		<transition to="金额判断1" name="同意付款"></transition>
		<transition to="修改申请单" name="退回业务修改"></transition>
		<transition to="更新状态为审批不通过" name="不同意付款"></transition>
		<transition to="股份公司副总审批" name="提交股份公司副总审批"></transition>
	</task-node>

	<task-node name="股份公司副总审批">
	    <task name="股份公司副总审批"></task>
		<transition to="股份公司常务副总审批" name="提交股份公司常务副总审批"></transition>
		<transition to="贸管经理审核" name="退回贸管"></transition>
		<transition to="更新状态为审批不通过" name="不同意付款"></transition>
	</task-node>

	<decision name="金额判断2">
		<handler config-type="bean" class="com.infolion.sapss.workflow.payment.Price2JudgeDecisionHandler"></handler>
		<transition to="股份公司总经理审批" name="大于500万USD或3500万CNY"></transition>
		<transition to="业务类型判断" name="小于500万USD或3500万CNY"></transition>
	</decision>

	<task-node name="股份公司常务副总审批">
	    <task name="股份公司常务副总审批"></task>
		<transition to="金额判断2" name="同意付款"></transition>
		<transition to="贸管经理审核" name="退回贸管"></transition>
		<transition to="更新状态为审批不通过" name="不同意付款"></transition>
	</task-node>

	<decision name="金额判断3">
		<handler config-type="bean" class="com.infolion.sapss.workflow.payment.Price3JudgeDecisionHandler"></handler>
		<transition to="股份公司董事长审批" name="大于1000万USD或7000万CNY"></transition>
		<transition to="业务类型判断" name="小于1000万USD或7000万CNY"></transition>
	</decision>

	<task-node name="股份公司总经理审批">
	    <task name="股份公司总经理审批"></task>
		<transition to="金额判断3" name="同意付款"></transition>
		<transition to="贸管经理审核" name="退回贸管"></transition>
		<transition to="更新状态为审批不通过" name="不同意付款"></transition>
	</task-node>

	<task-node name="股份公司董事长审批">
	    <task name="股份公司董事长审批"></task>
		<transition to="业务类型判断" name="同意付款"></transition>
		<transition to="贸管经理审核" name="退回贸管"></transition>
		<transition to="更新状态为审批不通过" name="不同意付款"></transition>
	</task-node>

	<task-node name="修改申请单">
	    <task name="修改申请单"></task>
		<transition to="部门经理确认" name="提交部门经理"></transition>
		<transition to="更新状态为审批不通过" name="作废该申请"></transition>
	</task-node>

	<task-node name="股份机要室人员审核">
	    <task name="股份机要室人员审核"></task>
		<transition to="更新状态为审批通过" name="确认"></transition>
	</task-node>

	<task-node name="出纳审核">
	    <task name="出纳审核"></task>
		<transition to="股份机要室人员审核" name="确认">
			<action class="com.infolion.sapss.workflow.payment.CreditPayTellerCheckActionHandler" config-type="bean"></action>
		</transition>
		<transition to="股份机要室确认部分付款" name="部分付款"></transition>
	</task-node>

	<node name="更新状态为审批通过">
		<action class="com.infolion.sapss.workflow.payment.ProcessSuccessActionHandler"></action>
		<transition to="结束（审批通过）"></transition>
	</node>

	<node name="更新状态为审批不通过">
		<action class="com.infolion.sapss.workflow.payment.ProcessFailureActionHandler"></action>
		<transition to="结束（审批不通过）"></transition>
	</node>

	<decision name="金额判断1">
		<handler config-type="bean" class="com.infolion.sapss.workflow.payment.Price1JudgeDecisionHandler"></handler>
		<transition to="业务类型判断" name="小于200万USD或1400万CNY"></transition>
		<transition to="股份公司副总审批" name="大于200万USD或1400万CNY"></transition>
	</decision>

	<decision name="业务类型判断">
		<handler config-type="bean" class="com.infolion.sapss.workflow.payment.BAJudgeDecisionHandler"></handler>
		<transition to="是否超过100万CNY" name="其它"></transition>
		<transition to="出纳确认" name="银行承兑汇票"></transition>
		<transition to="填写核销单" name="TT付款"></transition>
	</decision>
    <task-node name="填写核销单">
	    <task name="填写核销单"></task>
		<transition to="是否超过100万CNY" name="核销单已填写"></transition>
	</task-node>

	<task-node name="出纳确认">
	    <task name="出纳确认"></task>
		<transition to="机要室确认" name="确认">
			<action class="com.infolion.sapss.workflow.payment.CreditPayTellerCheckActionHandler" config-type="bean"></action>
		</transition>
	</task-node>

	<task-node name="机要室确认">
	    <task name="机要室确认"></task>
		<transition to="资金部人员确认并填写到期日" name="确认"></transition>
	</task-node>

	<task-node name="资金部人员确认并填写到期日">
	    <task name="资金部确认并填写到期日"></task>
		<transition to="更新状态为审批通过" name="确认并已填写到期日"></transition>
	</task-node>

	<decision name="是否金属部">
	    <handler config-type="bean" class="com.infolion.sapss.workflow.payment.Dept5AndTradeTypeDecisionHandler"></handler>
		<transition to="综合一部经理审批" name="是"></transition>
		<transition to="部门会计审核" name="否"></transition>
	</decision>

	<task-node name="综合一部经理审批">
	    <task name="综合一部经理审批"></task>
		<transition to="部门会计审核" name="同意"></transition>
		<transition to="修改申请单" name="退回修改申请单"></transition>
	</task-node>

	<task-node name="股份机要室确认部分付款">
	    <task name="股份机要室确认部分付款"></task>
		<transition to="出纳审核" name="确认部分付款"></transition>
	</task-node>

	<decision name="是否超过100万CNY">
		<handler config-type="bean" class="com.infolion.sapss.workflow.payment.Over100WDecisionHandler"></handler>
		<transition to="资金部经理确认（超过100万）" name="是"></transition>
		<transition to="特殊帐号处理" name="否"></transition>
	</decision>

	<task-node name="资金部经理确认（超过100万）">
	    <task name="资金部经理确认（超过100万）"></task>
		<transition to="特殊帐号处理" name="确认"></transition>
	</task-node>

	<decision name="特殊帐号处理">
		<handler config-type="bean" class="com.infolion.sapss.workflow.payment.SpecialAccountDecisionHandler"></handler>
		<transition to="出纳审核" name="正常帐号"></transition>
		<transition to="上海信达诺财务付款" name="上海信达诺帐号"></transition>
	</decision>

	<task-node name="上海信达诺财务付款">
	    <task name="上海信达诺财务付款"></task>
		<transition to="更新状态为审批通过" name="款已付"></transition>
	</task-node>


	<end-state name="结束（审批通过）"></end-state>

	<end-state name="结束（审批不通过）"></end-state>


</process-definition>