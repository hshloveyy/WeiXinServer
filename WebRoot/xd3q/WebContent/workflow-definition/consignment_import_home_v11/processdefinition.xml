<?xml version="1.0" encoding="UTF-8"?>

<process-definition  xmlns=""  name="consignment_import_home_v11">


	<start-state name="发货申请">
		<transition to="部门确认" name="提交部门经理确认"></transition>
	</start-state>


	<task-node name="财务审核">
	    <task name="财务审核"></task>
		<transition to="财务经理审核" name="同意发货"></transition>
		<transition to="业务确认" name="退回业务修改"></transition>
		<transition to="财务经理审核*" name="二次结算"><action config-type="bean" class="com.infolion.sapss.workflow.ship.ShipTransitionActionHandler"></action></transition>
	</task-node>

	<task-node name="部门确认">
	    <task name="部门确认"></task>
		<transition to="财务审核" name="确认提交"></transition>
		<transition to="业务确认" name="退回修改"></transition>
	</task-node>

	<task-node name="业务确认">
	    <task name="业务确认"></task>
		<transition to="部门确认" name="提交部门经理"></transition>
		<transition to="更新出仓单状态为不通过" name="作废申请"></transition>
	</task-node>

	<task-node name="外贸综合一部">
	    <task name="外贸综合一部"></task>
		<transition to="判断1" name="同意发货"></transition>
		<transition to="业务确认" name="退回业务修改"></transition>
	</task-node>

	<node name="更新出仓单状态为不通过">
		<action class="com.infolion.sapss.workflow.ship.ConsgmtImportFaileActionHandler" config-type="bean"></action>
		<transition to="发货申请不通过"></transition>
	</node>

	<node name="更新出仓单状态为通过">
		<action class="com.infolion.sapss.workflow.ship.ConsgmtImportSucessfulActionHandler" config-type="bean"></action>
		<transition to="发货申请通过"></transition>
	</node>

	<task-node name="综合部仓管员确认">
	    <task name="综合部仓管员确认"></task>
		<transition to="判断2" name="已在SAP系统做相关出库操作"></transition>
		<transition to="业务确认" name="退回修改"></transition>
	</task-node>

	<decision name="判断1">
	    <handler config-type="bean" class="com.infolion.sapss.workflow.ship.CommonJudge1DecisionHandler"></handler>
		<transition to="综合部仓管员确认" name="未开票"></transition>
		<transition to="开票员冲销发票" name="冲销且已开票"></transition>
	</decision>

	<task-node name="开票员冲销发票">
	    <task name="开票员冲销发票"></task>
		<transition to="综合部仓管员确认" name="确认，SAP票已冲销"></transition>
		<transition to="业务确认" name="退回修改"></transition>
	</task-node>

	<decision name="判断2">
	    <handler config-type="bean" class="com.infolion.sapss.workflow.ship.CommonJudge2DecisionHandler"></handler>
		<transition to="更新出仓单状态为通过" name="出仓单未开票"></transition>
		<transition to="开票员重新开票过账" name="出仓单已开票"></transition>
	</decision>

	<task-node name="开票员重新开票过账">
	    <task name="开票员重新开票过账"></task>
		<transition to="更新出仓单状态为通过" name="确认，SAP开票已重新过账"></transition>
	</task-node>

	<task-node name="信达安综合部">
	    <task name="信达安综合部"></task>
		<transition to="外贸综合一部" name="确认"></transition>
	</task-node>

	<task-node name="外贸综合一部*">
		<task name="外贸综合一部*"></task>
		<transition to="业务确认*" name="确认"></transition>
		<transition to="业务确认" name="退回修改"><action config-type="bean" class="com.infolion.sapss.workflow.ship.ShipTransitionActionHandler"></action></transition>
	</task-node>

	<task-node name="业务确认*">
		<task name="业务确认*"></task>
		<transition to="财务审核*" name="二次结算确认提交"></transition>
		<transition to="财务审核**" name="二次结算确认提交*"></transition>
		<transition to="财务审核" name="退回财务">
			<action class="com.infolion.sapss.workflow.ship.ShipTransitionActionHandler" config-type="bean"></action>
		</transition>
	</task-node>

	<task-node name="财务审核*">
		<task name="财务审核*"></task>
		<transition to="财务经理审核" name="确认"><action config-type="bean" class="com.infolion.sapss.workflow.ship.ShipTransitionActionHandler"></action></transition>
		<transition to="业务确认*" name="退回修改"></transition>
	</task-node>

	<task-node name="财务审核**">
	    <task name="财务审核**"></task>
		<transition to="财务经理审核**" name="确认"><action config-type="bean" class="com.infolion.sapss.workflow.ship.ShipTransitionActionHandler"></action></transition>
		<transition to="业务确认*" name="退回修改"></transition>
	</task-node>

	<task-node name="外贸综合一部**">
	    <task name="外贸综合一部**"></task>
		<transition to="业务确认*" name="确认"></transition>
	</task-node>

	<task-node name="财务经理审核*">
	    <task name="财务经理审核*"></task>
		<transition to="信达安综合部*" name="确认"></transition>
		<transition to="业务确认" name="退回修改"><action config-type="bean" class="com.infolion.sapss.workflow.ship.ShipTransitionActionHandler"></action></transition>
	</task-node>

	<task-node name="信达安综合部*">
	    <task name="信达安综合部*"></task>
		<transition to="外贸综合一部*" name="确认"></transition>
		<transition to="业务确认" name="退回修改"><action config-type="bean" class="com.infolion.sapss.workflow.ship.ShipTransitionActionHandler"></action></transition>
	</task-node>

	<task-node name="财务经理审核">
	    <task name="财务经理审核"></task>
		<transition to="信达安综合部" name="确认"></transition>
		<transition to="业务确认" name="退回"></transition>
	</task-node>

	<task-node name="财务经理审核**">
	    <task name="财务经理审核**"></task>
		<transition to="信达安综合部**" name="确认"></transition>
		<transition to="业务确认*" name="退回"></transition>
	</task-node>

	<task-node name="信达安综合部**">
	    <task name="信达安综合部**"></task>
		<transition to="外贸综合一部**" name="确认"></transition>
	</task-node>


	<end-state name="发货申请不通过"></end-state>

	<end-state name="发货申请通过"></end-state>


</process-definition>