<?xml version="1.0" encoding="UTF-8"?>

<process-definition  xmlns=""  name="project_v3">


	<start-state name="立项申请">
		<transition to="部门确认" name="提交部门经理确认"></transition>
	</start-state>


	<task-node name="部门确认">
		<task name="部门确认"></task>
		<transition to="关联单位判断" name="确认提交"></transition>
		<transition to="项目报审表修改" name="退回修改"></transition>
	</task-node>

	<task-node name="证券部审核">
		<task name="证券部审核"></task>
		<transition to="财务部审核" name="通过"></transition>
		<transition to="项目报审表修改" name="退回项目报审表修改"></transition>
		
	</task-node>

	<task-node name="信达安贸管审核">
		<task name="信达安贸管审核"></task>
		<transition to="股份贸管补录确认" name="非自有业务"></transition>
		<transition to="信达安总经理审核" name="自有业务"></transition>
		<transition to="项目报审表修改" name="退回修改"></transition>
	</task-node>

	<task-node name="信达安总经理审核">
		<task name="信达安总经理审核"></task>
		<transition to="金额判断" name="同意"></transition>
		<transition to="项目报审表修改" name="退回修改"></transition>
	</task-node>

	<task-node name="项目报审表修改">
		<task name="项目报审表修改"></task>
		<transition to="部门确认" name="提交部门经理"></transition>
		<transition to="更新项目状态为不通过" name="作废"></transition>
	</task-node>

	<decision name="关联单位判断">
		<handler config-type="bean" class="com.infolion.sapss.workflow.decision.UnitJudgeDecisionHandler"></handler>
		<transition to="证券部审核" name="关联单位并且金额大于300万或金额大于6亿">
		</transition>
		<transition to="财务部审核" name="非关联单位"></transition>
	</decision>

	<node name="更新项目状态">
		<action class="com.infolion.sapss.workflow.project.ProcessSucessfulActionHandler"></action>
		<transition to="立项申请通过"></transition>
	</node>

	<node name="更新项目状态为不通过">
		<action class="com.infolion.sapss.workflow.project.ProcessFaileActionHandler"></action>
		<transition to="立项申请不通过"></transition>
	</node>

	<task-node name="股份贸管补录确认">
	    <task name="股份贸管补录确认"></task>
		<transition to="系统判断" name="确认"></transition>
		<transition to="项目报审表修改" name="退回修改"></transition>
	</task-node>

	<decision name="系统判断">
	    <handler config-type="bean" class="com.infolion.sapss.workflow.decision.CreditValueDecisionHandler"></handler>
		<transition to="风险管理部审核" name="授信项目"></transition>
		<transition to="更新项目状态" name="非授信项目"></transition>
	</decision>

	<task-node name="风险管理部审核">
	    <task name="风险管理部审核"></task>
		<transition to="更新项目状态" name="确认"></transition>
	</task-node>

	<task-node name="财务部审核">
	    <task name="财务部审核"></task>
		<transition to="资金部审核" name="同意"></transition>
		<transition to="项目报审表修改" name="退回修改"></transition>
	</task-node>

	<task-node name="资金部审核">
	    <task name="资金部审核"></task>
		<transition to="信达安贸管审核" name="同意"></transition>
		<transition to="项目报审表修改" name="退回修改"></transition>
	</task-node>

	<task-node name="信达安董事长审批">
	    <task name="信达安董事长审批"></task>
		<transition to="股份贸管报备" name="同意">
		<action config-type="bean" class="com.infolion.sapss.workflow.XinDaAnMgBbActionHandler"></action>
		</transition>
		<transition to="项目报审表修改" name="退回"></transition>
	</task-node>

	<decision name="金额判断">
	    <handler config-type="bean" class="com.infolion.sapss.workflow.decision.PriceJudge3000USDDecisionHandler"></handler>
		<transition to="信达安董事长审批" name="金额大于3000万USD"></transition>
		<transition to="股份贸管报备" name="金额小于3000万USD">
		<action config-type="bean" class="com.infolion.sapss.workflow.XinDaAnMgBbActionHandler"></action>
		</transition>
	</decision>

	<task-node name="股份贸管报备">
	    <task name="股份贸管报备"></task>
		<transition to="系统判断" name="确认"></transition>
		<transition to="信达安贸管审核" name="退回信达安贸管"></transition>
	</task-node>


	<end-state name="立项申请通过"></end-state>

	<end-state name="立项申请不通过"></end-state>


</process-definition>